# Eye Game - README（日本語版）

Eye Game は、顔の表情だけで自機を操作するフェイストラッキング実験型シューティングゲームです。  
リポジトリにはシングルプレイ・PvP モード、コンピュータビジョンによる顔追跡、各種ユーティリティが含まれています。

## ■ プロジェクト構成

### single_shooter.py  
シングルプレイヤー向けの「視線シューティング」。  
ワールド空間内の敵、ボスの多段階フェーズ、アイテム、表情による照準・武器・シールド操作を実装。

### pvp_shooter.py  
UDP（リアルタイム状態）＋ TCP（敵スポーン同期）を用いた PvP 対戦。  
権威モデル・スポーン管理・相手プレイヤーの顔スプライト送受信などを含む。

### detect_face.py  
Mediapipe を用いた顔・表情トラッカー。  
正規化された視線、口の開き、目の開閉などを UDP 送信する。

---

## ■ 表情による操作（Controls）

- **視線 (x, y)**  
  クロスヘア（照準）と、片目モード時のカメラパンを制御。
- **口の形**  
  弾 / 拡散ショット / ビーム の選択（アスペクト比と口幅の閾値で判定）。
- **目の開閉**  
  両目を閉じるとシールドゲージが蓄積し、一定時間で発動。
- **眉の動き**  
  アイテム使用のトリガー。

---

## ■ シングルモードの特徴

- 画面より大きい「ワールド座標系」と、プレイヤーを中心としたカメラ操作。
- 多段階のボス（フェーズごとに移動パターン・攻撃頻度が変化）。
- 敵のスポーン管理、弾の寿命(TTL)、被弾時のひび割れエフェクト（1つだけ表示）。
- アイテム（HP回復、攻撃力アップ、ショットガン解放、ビーム解放）。
- パーティクル演出、αブレンドの HUD、画面外の敵インジケータ。
- 敵弾数の上限管理による負荷軽減。

---

## ■ PvP モードの特徴

- **Player1 が権威 (authority)** としてスポーンや撃破判定を管理。
- UDP により両プレイヤーの位置・射撃イベントなどを高速同期。
- Mediapipe で撮影した相手の顔画像を HUD に表示。

---

## ■ 依存ライブラリ・セットアップ

- Python 3  
- OpenCV (cv2)  
- numpy  
- pygame  
- Mediapipe  

画像は `img/`、効果音は `sound/` に配置。  
顔追跡には最初に `detect_face.py` を実行し、UDP 送信を開始しておく必要があります。

---

## ■ 実行方法

### シングルモード
```
python single_shooter.py
```
※ 事前に `detect_face.py` を起動しておくこと。

### PvP モード
```
python pvp_shooter.py --listen 6000 --connect 6001
```
など、適切なポート設定で 2 クライアントを起動。Player1 側が権威として機能。

### ランチャー
```
python launcher_pygame.py
```
UI からシングル／PvP を選択できる（設定済みの場合）。
